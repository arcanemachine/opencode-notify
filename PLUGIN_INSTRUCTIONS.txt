Two Ways to Load a Local Plugin

OpenCode automatically loads any .js or .ts file placed in one of two plugin directories — no extra configuration needed:​

    Project-level (only applies to the current project): .opencode/plugins/

    Global (applies everywhere): ~/.config/opencode/plugins/

Just drop your plugin file into either directory and it will be picked up at startup.​
Basic Plugin Structure

A plugin is a JavaScript or TypeScript module that exports an async function:​
ts

import type { Plugin } from "@opencode-ai/plugin"

export const MyPlugin: Plugin = async ({ project, client, $, directory, worktree }) => {
  console.log("Plugin loaded!")

  return {
    // Hook implementations go here
  }
}

The function receives a context object with:​

    project — current project info

    directory — current working directory

    worktree — git worktree path

    client — OpenCode SDK client for interacting with the AI

    $ — Bun's shell API for running commands

Using External npm Packages

If your plugin depends on external npm packages, add a package.json to your config directory:​
json

{
  "dependencies": {
    "some-package": "^1.0.0"
  }
}

OpenCode automatically runs bun install at startup to install them. Cached modules are stored at ~/.cache/opencode/node_modules/.​
Adding Custom Tools

Your plugin can also expose custom tools that the AI can call:​
ts

import { type Plugin, tool } from "@opencode-ai/plugin"

export const MyPlugin: Plugin = async (ctx) => {
  return {
    tool: {
      mytool: tool({
        description: "Does something useful",
        args: { input: tool.schema.string() },
        async execute(args, context) {
          return `You said: ${args.input}`
        },
      }),
    },
  }
}

Available Event Hooks

You can subscribe to a wide range of events, including:​

    Session events: session.created, session.idle, session.error, session.diff

    File events: file.edited, file.watcher.updated

    Tool events: tool.execute.before, tool.execute.after

    Message events: message.updated, message.part.updated

    TUI events: tui.prompt.append, tui.toast.show

Plugin Load Order

If you use both global and project-level plugins, they load in this order:​

    Global config (~/.config/opencode/opencode.json)

    Project config (opencode.json)

    Global plugin directory (~/.config/opencode/plugins/)

    Project plugin directory (.opencode/plugins/)

All hooks from every source run in sequence, so order can matter if plugins interact with the same events.
